<div class=" mb-3">
  <div class="banner" style="background-image: linear-gradient(rgba(0,0,0,0.4),rgba(0,0,0,0.4)), url('<%= asset_path("movie.jpg") %>');">
    <div class="container">
      <h1><%= @list.name %></h1>
    </div>
  </div>
</div>
<div class="center-nav d-flex">
  <div class=" container header display-6" >Movies</div>
    <button type="button"
        class="btn btn-success me-3"
        data-bs-toggle="modal"
        data-bs-target="#addMovieModal">
  Add a movie +
</button>
    <%= link_to "Create a list +", new_list_path, class: "btn btn-success me-3" %>
    <%= link_to "Delete List ", list_path(@list), class: "btn btn-danger me-3", data: {turbo_method: :delete, turbo_confirm: "Are you sure?"} %>
  </div>
<div class="container mb-3 mt-3">
  <div class="cards">
    <% @list.movies.each do |m| %>
     <div class="card-product">
  <%= image_tag m.poster_url, alt: "text" %>
  <div class="card-product-infos">
    <h2><%= m.title %></h2>
    <p><%= m.overview[0..100]... %> </p>
    <p><%= m.rating %> </p>
    <% bookmark = @list.bookmarks.find_by(movie: m) %>
    <% if bookmark.present? %>
    <p><em>--<%= bookmark.comment %></em> </p>
    <%= link_to list_bookmark_path(@list, bookmark), data: {turbo_method: :delete, turbo_confirm: "Are you sure?"} do %>
    <i class="fa-solid fa-trash"></i>
    <% end %>
    <% end %>
  </div>
</div>
    <% end %>
  </div>
  <div class="container mt-3 d-flex justify-content-center">
    <%= link_to "Home", root_path %>
  </div>
</div>


<!-- Add Movie Modal -->
<div class="modal fade" id="addMovieModal" tabindex="-1" aria-labelledby="addMovieModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">

      <div class="modal-header">
        <h1 class="modal-title fs-5" id="addMovieModalLabel">Add a Movie</h1>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>

      <div class="modal-body">
        <div class="container bg-light card mt-3 p-4" style="max-width: 400px;">
          <%= simple_form_for [@list, @bookmark] do |f| %>
            <%= f.error_notification %>
            <%= f.error_notification message: f.object.errors[:base].to_sentence if f.object.errors[:base].present? %>

            <div class="form-inputs d-flex flex-column gap-3">
              <%= f.input :comment, input_html: { class: "form-control" } %>
              <%= f.association :movie, include_blank: "Select a movie", input_html: { class: "form-select" } %>
            </div>

            <div class="form-actions mt-3 d-flex justify-content-center">
              <%= f.button :submit, "Add Movie", class: "btn btn-primary w-100" %>
            </div>
          <% end %>
        </div>
      </div>

    </div>
  </div>
</div>
